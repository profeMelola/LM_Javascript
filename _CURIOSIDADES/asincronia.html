<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sincronismo/Asincronismo</title>
</head>

<body>
    <script>
        // ------------------- SÍNCRONO ------------------------------
        /*
          Tenemos un array numbers, en el cuál insertaremos números. 
          Insertaremos la cantidad de números que figura en iterations. 
          En cada iteración se insertará un number, 
          que habrá sido generado con una simulación del lanzamiento de un dado (un número aleatorio del 1 al 6). 
          En el caso de obtener un 6, paramos y rompemos el bucle
         */
        const iterations = 10;
        const numbers = [];

        for (let i = 0; i < iterations; i++) {
            const number = 1 + Math.floor(Math.random() * 6);
            numbers.push(number);
            if (number === 6) {
                console.log("ERROR");
                break;
            }
        }

        console.log(numbers);

        // ------------------- ASÍNCRONO --------------------------------
        /*function doTask(number, callback) {
            //Código de la función
        }

        doTask(42, function (err, result) {
            //Trabajamos con err o result según nos interese
        });*/


        /* Implementación con callbacks */
        const doTask = (iterations, callback) => {
            const numbers = [];
            for (let i = 0; i < iterations; i++) {
                const number = 1 + Math.floor(Math.random() * 6);
                numbers.push(number);
                if (number === 6) {
                    /* Error, se ha sacado un 6 */
                    callback({
                        error: true,
                        message: "Se ha sacado un 6"
                    });
                    return;
                }
            }
            /* Termina bucle y no se ha sacado 6 */
            return callback(null, {
                error: false,
                value: numbers
            });
        }

        doTask(10, function (err, result) {
            if (err) {
                console.error("Se ha sacado un ", err.message);
                return;
            }
            console.log("Tiradas correctas: ", result.value);
        });
    </script>
</body>

</html>